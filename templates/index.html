{% extends "base.html" %}

{% block title %}My EuroCoins{% endblock %}

{% block description %}Discover the complete collection of Euro coins from 1999 to 2025. Browse 832 coins including 284 regular and 547 commemorative coins from all 27 eurozone countries.{% endblock %}

{% block canonical_path %}/{% endblock %}

{% block main_class %}bg-light{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section bg-primary text-white py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8 text-center">
                <div class="hero-content">
                    <h1 class="display-4 fw-bold mb-4">
                        My EuroCoins
                    </h1>
                    <p class="lead mb-4">
                        Discover regular circulation and commemorative coins from all eurozone countries.
                    </p>
                    <!-- data source moved to footer -->
                    <a href="{% if group_context %}{% if selected_member %}/{{ group_context.group_key }}/{{ selected_member }}/catalog{% else %}/{{ group_context.group_key }}/catalog{% endif %}{% else %}/catalog{% endif %}" class="btn btn-light btn-lg">
                        <i class="fas fa-search me-2"></i>Browse Catalog
                    </a>
                    
                    <!-- Latest coins rotator (Hero) simplified -->
                    <div class="d-flex justify-content-center mt-4">
                        <div id="hero-latest-coin" class="card hero-coin-card text-white text-center" style="width: 240px;">
                            <div class="card-body py-2 d-flex flex-column align-items-center">
                                <img id="hero-coin-img" src="/static/images/myeurocoins-icon.png" alt="coin" class="hero-coin-img mb-2" style="width:96px;height:96px;object-fit:cover;border-radius:50%;background:#fff;">
                                <div class="d-flex justify-content-between align-items-center w-100 mt-2">
                                    <h6 class="card-title mb-0 text-start">
                                        <span class="country-flag me-2" id="hero-country-flag">ðŸ‡ªðŸ‡º</span>
                                        <span id="hero-country" class="fw-semibold"></span>
                                    </h6>
                                    <span id="hero-value" class="h5 mb-0 text-white fw-bold"></span>
                                </div>
                                <div class="w-100 mt-1">
                                    <p id="hero-type-year" class="card-text text-white-50 small mb-0"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                                    <!-- Compact stats inside hero -->
                                    <div class="d-flex justify-content-center align-items-center mt-4 gap-3 flex-wrap">
                                        <div class="text-center text-white-75 small">
                                            <div class="fw-bold fs-5">{{ stats.total_coins or 0 }}</div>
                                            <div class="text-white-50">Coins</div>
                                        </div>
                                        <div class="text-center text-white-75 small">
                                            <div class="fw-bold fs-5">{{ stats.total_countries or 0 }}</div>
                                            <div class="text-white-50">Countries</div>
                                        </div>
                                        <div class="text-center text-white-75 small">
                                            <div class="fw-bold fs-5">{{ stats.regular_coins or 0 }}</div>
                                            <div class="text-white-50">Regular</div>
                                        </div>
                                        <div class="text-center text-white-75 small">
                                            <div class="fw-bold fs-5">{{ stats.commemorative_coins or 0 }}</div>
                                            <div class="text-white-50">Commemorative</div>
                                        </div>
                                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script>
// Add some simple animations
document.addEventListener('DOMContentLoaded', function() {
    // Animate stats on scroll
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('animate__fadeInUp');
            }
        });
    });
    
    document.querySelectorAll('.card').forEach(card => {
        observer.observe(card);
    });
});
</script>
<script src="/static/js/flags.js"></script>
<script>
// Hero latest coins rotator (emoji flags)
document.addEventListener('DOMContentLoaded', function() {
    const coins = {{ latest_coins | default([]) | tojson }};
    if (!coins || coins.length === 0) return;

    let idx = 0;
    const countryEl = document.getElementById('hero-country');
    const valueEl = document.getElementById('hero-value');
    const flagEl = document.getElementById('hero-country-flag');
    const cardEl = document.getElementById('hero-latest-coin');
    const imgEl = document.getElementById('hero-coin-img');
    const typeYearEl = document.getElementById('hero-type-year');

    function setCoin(c) {
        const flag = (typeof window !== 'undefined' && typeof window.getCountryFlag === 'function')
            ? window.getCountryFlag(c.country)
            : 'ðŸ‡ªðŸ‡º';

    flagEl.textContent = flag;
    countryEl.textContent = c.country || '';
    valueEl.textContent = c.value ? `â‚¬${parseFloat(c.value).toFixed(2)}` : '';
    imgEl.src = c.image || c.image_url || '/static/images/coin-placeholder.png';
    imgEl.alt = `${c.country || ''} coin`;
    // Type + year: map RE -> Regular, CC -> Commemorative
    const typeLabel = c.coin_type === 'RE' ? 'Regular' : (c.coin_type === 'CC' ? 'Commemorative' : c.coin_type || '');
    // Show a middot between type and year when both are present, e.g. "Commemorative â€¢ 2024"
    let typeYearText = '';
    if (typeLabel && c.year) {
        typeYearText = `${typeLabel} \u2022 ${c.year}`;
    } else if (typeLabel) {
        typeYearText = typeLabel;
    } else if (c.year) {
        typeYearText = `${c.year}`;
    }
    typeYearEl.textContent = typeYearText;

        // Small 3D highlight animation
        cardEl.classList.remove('hero-card-pop');
        void cardEl.offsetWidth; // force reflow
        cardEl.classList.add('hero-card-pop');
    }

    // Initial
    setCoin(coins[idx]);

    // Rotate every 4 seconds
    setInterval(function() {
        idx = (idx + 1) % coins.length;
        setCoin(coins[idx]);
    }, 4000);
});
</script>
{% endblock %}
